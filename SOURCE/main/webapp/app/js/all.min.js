var gabblerApp=angular.module("gabblerApp",["ngRoute","ngAnimate","gabbler.translate","gabbler.login.service","gabbler.menu","gabbler.login","gabbler.register","gabbler.home","gabbler.timeline"]);gabblerApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"/main/webapp/app/js/modules/index/home.html",controller:"indexCtrl"}),e.when("/timeline",{templateUrl:"/main/webapp/app/js/modules/timeline/timeline.html"})}]).run(["$http",function(e){e.defaults.headers.post={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"x-requested-with"}}]),angular.module("gabbler.home",["gabbler.menu","gabbler.login","gabbler.register"]).controller("indexCtrl",["$scope","AuthenticationService",function(e,t){e.pageClass="indexPageClass",t.ClearCredentials()}]),angular.module("gabbler.translate",["pascalprecht.translate","ngCookies"]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"/main/webapp/app/js/modules/languages/",suffix:".json"}),e.preferredLanguage("en")}]).controller("MainCtrl",["$scope","$translate",function(e,t){e.changeLanguage=function(e){t.use(e)}}]),angular.module("gabbler.menu",[]).directive("menu",function(){return{restrict:"E",scope:!0,replace:!0,templateUrl:"/main/webapp/app/js/modules/menu/menu.html"}}).controller("menuCtrl",["$scope","$cookieStore","$location","AuthenticationService",function(e,t,n,r){setInterval(function(){e.$apply(function(){var t=r.GetCredentials();e.nickname="undefined"==typeof t.currentUser?"":t.currentUser.username})},2e3),e.logout=function(){r.Logout(function(){})}}]),angular.module("gabbler.login",[]).controller("loginCtrl",["$scope","$rootScope","$cookieStore","$location","AuthenticationService","$route",function(e,t,n,r,o){e.login=function(){e.dataLoading=!0,o.Login(e.username,e.pwd,function(t){t.token?(o.SetCredentials(e.username,t.token),e.dataLoading=!1,r.path("/timeline")):(e.error="Invalid credentials",e.dataLoading=!1)})}}]).directive("login",function(){return{restrict:"E",controller:"loginCtrl",templateUrl:"/main/webapp/app/js/modules/login/login.html"}}),angular.module("gabbler.register",["gabbler.register.service","gabbler.login.service"]).controller("registerCtrl",["$scope","$rootScope","$location","RegisterService","AuthenticationService",function(e,t,n,r,o){e.register=function(){e.dataLoading=!0,r.Register(e.lastname,e.firstname,e.username,e.pwd,function(t){t.success?(o.Login(e.username,e.pwd),o.SetCredentials(e.username,e.pwd),n.path("/wall")):(e.error=t.message,e.dataLoading=!1)})}}]).directive("register",function(){return{restrict:"E",templateUrl:"/main/webapp/app/js/modules/register/register.html"}}),angular.module("gabbler.timeline",["gabbler.timeline.service"]).controller("profileOverviewCtrl",["$scope","$cookieStore","$location","AuthenticationService","TimelineServices",function(e,t,n,r,o){var a=null;e.token=t.get("globals").currentUser.token,o.GetProfilePreview("0",function(t){t.id&&(a=t,e.firstname=t.firstname,e.lastname=t.lastname,e.nickname=t.nickname,e.result=a.data)})}]).controller("timelineCtrl",["$scope","$cookieStore","$location","TimelineServices",function(e,t,n,r){e.addGab=function(){var t=e.gab;r.AddAGab(t,function(t){0!==t.id&&r.GetMyGabs(function(t){var n=t;for(var r in n)if(n.hasOwnProperty(r)){var o=new Date(1e3*n[r].postDate),a=o.getHours(),i="0"+o.getMinutes(),l="0"+o.getSeconds(),s=a+":"+i.substr(i.length-2)+":"+l.substr(l.length-2);e.date=s}e.gabs=n})})}}]).controller("suggestionsCtrl",["$scope","$cookieStore","$location",function(){}]),angular.module("gabbler.timeline.service",[]).factory("TimelineServices",["$http","$cookieStore","$rootScope","$timeout",function(e,t){var n={};return n.GetProfilePreview=function(n,r){var o=t.get("globals").currentUser.token;e.defaults.headers.get={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"*",sessionAuthToken:o};"0"===n?e.get("http://localhost:8082/gabbler/api/user/get?userId=2").success(function(e,t){r(e,t)}).error(function(e,t){r(e,t)}):"0"!==n&&e.get("http://localhost:8082/gabbler/api/user/get?userId="+n).success(function(e,t){r(e,t)}).error(function(e,t){r(e,t)})},n.AddAGab=function(n,r){var o=(new Date,t.get("globals").currentUser.token),a={content:n,userId:2,postDate:"2015-02-22"};e.defaults.headers.post={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Raw",sessionAuthToken:o},e.post("http://localhost:8082/gabbler/api/gabs/publish",a).success(function(e,t){r(e,t)}).error(function(e,t){r(e,t)})},n.GetMyGabs=function(n){var r=t.get("globals").currentUser.token;e.defaults.headers.get={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"*",sessionAuthToken:r},e.get("http://localhost:8082/gabbler/api/gabs/timeline/user?userId=2&startIndex=0&count=20").success(function(e,t){n(e,t)}).error(function(e,t){n(e,t)})},n}]),angular.module("gabbler.login.service",[]).factory("AuthenticationService",["Base64","$http","$cookieStore","$rootScope","$timeout",function(e,t,n,r){var o={};return o.Login=function(e,n,r){var o={password:n,username:e};t.post("http://localhost:8082/gabbler/api/login",o).success(function(e,t){r(e,t)}).error(function(e,t){r(e,t)})},o.Logout=function(e){var r={token:n.get("globals").currentUser.token},o={headers:{"Content-Type":"application/json"}};t.get("http://localhost:8082/gabbler/api/logout",o,r).success(function(t,n){e(t,n)}).error(function(t,n){e(t,n)})},o.SetCredentials=function(e,o){r.globals={currentUser:{username:e,token:o}},t.defaults.headers.common.Authorization="Basic "+o,n.put("globals",r.globals)},o.GetCredentials=function(){return n.get("globals")},o.ClearCredentials=function(){r.globals={},n.remove("globals"),n.remove("UserToken"),t.defaults.headers.common.Authorization="Basic "},o}]).factory("Base64",function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){var n,r,o,a,i,l="",s="",c="",u=0;do n=t.charCodeAt(u++),r=t.charCodeAt(u++),s=t.charCodeAt(u++),o=n>>2,a=(3&n)<<4|r>>4,i=(15&r)<<2|s>>6,c=63&s,isNaN(r)?i=c=64:isNaN(s)&&(c=64),l=l+e.charAt(o)+e.charAt(a)+e.charAt(i)+e.charAt(c),n=r=s="",o=a=i=c="";while(u<t.length);return l},decode:function(t){var n,r,o,a,i,l="",s="",c="",u=0,g=/[^A-Za-z0-9\+\/\=]/g;g.exec(t),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=e.indexOf(t.charAt(u++)),a=e.indexOf(t.charAt(u++)),i=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),n=o<<2|a>>4,r=(15&a)<<4|i>>2,s=(3&i)<<6|c,l+=String.fromCharCode(n),64!=i&&(l+=String.fromCharCode(r)),64!=c&&(l+=String.fromCharCode(s)),n=r=s="",o=a=i=c="";while(u<t.length);return l}}}),angular.module("gabbler.register.service",[]).factory("RegisterService",["$http","$cookieStore","$rootScope","$timeout",function(e,t,n,r){var o={};return o.Register=function(e,t,n,o,a){r(function(){if(""!==e&&""!==t&&""!==n&&""!==o){var r={success:"true"};"true"===r.success&&(r.message="One field is incorrect"),a(r)}},1e3)},o}]);